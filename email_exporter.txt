function bounceexporter(){

//googlesheets doesn't like loops larger than 500, so we have to do perform this task one subset at a time
var max =500;
var offset = 0;

while (true){

//getting bounced emails in label
  var label = GmailApp.getUserLabelByName('Bouncebacks');
  var threads=label.getThreads(offset, max);


  Logger.log("there are " + threads.length + " emails in this label")
  
//exports bounces to whatever sheet is active, change to a specific sheet if needed  
  var activeSheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();


//i indicates which number out of the entire bounce list we are up to
  for(var i = threads.length - 1; i >=0; i--){
    //storing the row of interest
    var messages = threads[i].getMessages();

    //n indicates which sender in the thread
    for (var n = 0; n < messages.length; n++) {
      var message = messages[n];
      var senderDetails_raw=message.getPlainBody()
      
      

     //extracting the email address out of the textbody
     //bounce emails have different formats, theses are the common ones
     
     
     if (senderDetails_raw.indexOf("wasn't delivered to")>-1){
        var senderDetails=message.getPlainBody().substring(senderDetails_raw.indexOf("wasn't delivered to ")+20,senderDetails_raw.indexOf(" because"));
        activeSheet.appendRow([senderDetails])
      }
      else if (senderDetails_raw.indexOf("** Message blocked **")>-1){
        var senderDetails=message.getPlainBody().substring(senderDetails_raw.indexOf("Your message to ")+16,senderDetails_raw.indexOf(" has been blocked."));
        activeSheet.appendRow([senderDetails])      
      }
      else if (senderDetails_raw.indexOf("https://products.office.com/en-us/CMSImages")>-1){
        var senderDetails=message.getPlainBody().substring(senderDetails_raw.indexOf("Your message to ")+18,senderDetails_raw.indexOf(" couldn't be delivered."))
        activeSheet.appendRow([senderDetails])      
      }
      else if (senderDetails_raw.indexOf(")<mailto:")>-1){
        var senderDetails=message.getPlainBody().substring(senderDetails_raw.indexOf(")<mailto:")+9,senderDetails_raw.indexOf(">"));
        activeSheet.appendRow([senderDetails])  
      }

      else if (senderDetails_raw.indexOf("rfc822;")>-1){
        var senderDetails=message.getPlainBody().substring(senderDetails_raw.indexOf("<")+1,senderDetails_raw.indexOf(">"));
        activeSheet.appendRow([senderDetails])  
      }

      else if (senderDetails_raw.indexOf("If you do so, please include this problem report")>-1){
        var senderDetails=message.getPlainBody().substring(senderDetails_raw.indexOf("<")+1,senderDetails_raw.indexOf(">"));
        activeSheet.appendRow([senderDetails])  
      }

      else if (senderDetails_raw.indexOf("Domino")>-1){
        var senderDetails=message.getPlainBody().substring(senderDetails_raw.indexOf("(")+1,senderDetails_raw.indexOf(")"));
        activeSheet.appendRow([senderDetails])  
      }

      else if (senderDetails_raw.indexOf("Symantec")>-1){
        var senderDetails=message.getPlainBody().substring(senderDetails_raw.indexOf("following addresses:")+20,senderDetails_raw.indexOf("Reason"));
        activeSheet.appendRow([senderDetails])  
      }

      else if (senderDetails_raw.indexOf("This is a delivery failure not")>-1){
        var senderDetails=message.getPlainBody().substring(senderDetails_raw.indexOf("-- ")+3,senderDetails_raw.indexOf("could n"));
        activeSheet.appendRow([senderDetails])  
      }

      else if (senderDetails_raw.indexOf("There was a temporary problem ")>-1){
        var senderDetails=message.getPlainBody().substring(senderDetails_raw.indexOf("g your message to")+17,senderDetails_raw.indexOf(">"));
        activeSheet.appendRow([senderDetails])  
      }
  


  //activeSheet.appendRow([senderDetails_raw])  
      
          



      //k indicates which row in the sheet is being checked for the particular n



    }
  }
  
  if (threads.length<max){
    break
  }
  
  offset += max;

  }
}
